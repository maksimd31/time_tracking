{% load custom_filters %}
{# Вариант редактирования без <form> вокруг <tr>: используем hx-post на кнопке + hx-include для сериализации инпутов #}
<tr id="interval-{{ interval.id }}" class="table-warning">
    <td class="text-muted-soft fw-semibold" style="font-feature-settings:'tnum';">{{ number }}</td>
    <td>
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
        <input type="hidden" name="num" value="{{ number }}">
        {# Пробрасываем активные фильтры, чтобы form_valid мог пересчитать статистику #}
        {% if filter_start %}<input type="hidden" name="start" value="{{ filter_start|date:'Y-m-d' }}">{% endif %}
        {% if filter_end %}<input type="hidden" name="end" value="{{ filter_end|date:'Y-m-d' }}">{% endif %}
        {{ form.day }}
    </td>
    <td>{{ form.start_time }}</td>
    <td>{{ form.end_time }}</td>
    <td>{% if interval.duration %}{{ interval.duration|duration_format }}{% else %}—{% endif %}</td>
    <td class="text-end">
        <button type="button"
                class="btn btn-primary btn-sm"
                hx-post="{% url 'interval_update' interval.id %}"
                hx-include="#interval-{{ interval.id }}"
                hx-target="#interval-{{ interval.id }}"
                hx-swap="outerHTML">
            Сохранить
        </button>
        <button type="button"
                class="btn btn-outline-secondary btn-sm"
                hx-get="{% url 'interval_update' interval.id %}?mode=display"
                hx-target="#interval-{{ interval.id }}"
                hx-swap="outerHTML">
            Отмена
        </button>
    </td>
</tr>
