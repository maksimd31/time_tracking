{% load custom_filters %}
<tr id="interval-{{ interval.id }}" class="history-row"
    hx-get="{% url 'interval_update' interval.id %}"
    hx-trigger="dblclick"
    hx-target="this"
    hx-swap="outerHTML">
    <td class="text-muted-soft fw-semibold" style="font-feature-settings:'tnum';">{{ number }}</td>
    <td>{{ interval.day|date:'d.m.Y' }}</td>
    <td>{{ interval.start_time|default:"—" }}</td>
    <td>{% if interval.end_time %}{{ interval.end_time }}{% else %}<span class="text-success fw-semibold">Активный</span>{% endif %}</td>
    <td>{% if interval.duration %}{{ interval.duration|duration_format }}{% else %}—{% endif %}</td>
    <td class="text-end">
    <button type="button" class="btn-icon btn-icon-edit"
        aria-label="Редактировать интервал {{ number }}"
        hx-get="{% url 'interval_update' interval.id %}?num={{ number }}{% if filter_start %}&start={{ filter_start|date:'Y-m-d' }}{% endif %}{% if filter_end %}&end={{ filter_end|date:'Y-m-d' }}{% endif %}"
                hx-target="#interval-{{ interval.id }}"
                hx-swap="outerHTML">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 20h4.586a2 2 0 0 0 1.414-.586L20 9.414a2 2 0 0 0 0-2.828l-2.586-2.586a2 2 0 0 0-2.828 0L4 14.586A2 2 0 0 0 3.414 16V20a0 0 0 0 0 0 0Z" />
                <path d="M12 6l6 6" />
            </svg>
        </button>
    <button type="button" class="btn-icon btn-icon-danger"
                aria-label="Удалить интервал {{ number }}"
        hx-delete="{% url 'interval_delite_htmx' interval.id %}"
        {% if filter_start or filter_end %}
        hx-vals='{
        {% if filter_start %}"start":"{{ filter_start|date:"Y-m-d" }}"{% endif %}
        {% if filter_start and filter_end %}, {% endif %}
        {% if filter_end %}"end":"{{ filter_end|date:"Y-m-d" }}"{% endif %}
        }'
        {% endif %}
                hx-target="#interval-{{ interval.id }}"
                hx-swap="outerHTML"
                hx-confirm="Удалить интервал?">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 7h16" />
                <path d="M10 11v6" />
                <path d="M14 11v6" />
                <path d="M6 7l1 12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2l1-12" />
                <path d="M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
            </svg>
        </button>
    </td>
</tr>
